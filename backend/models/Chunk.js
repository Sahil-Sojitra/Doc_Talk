/**
 * Chunk Model (Future Use)
 * This will store split text chunks from documents for RAG (Retrieval-Augmented Generation).
 * Currently a placeholder - will be fully implemented when adding AI chat features.
 * 
 * What is a Chunk?
 * When a document is too long, we split it into small pieces:
 * - Document: [Page 1] [Page 2] [Page 3] [Page 4]
 * - Chunk: "In 1989, Tim Berners-Lee invented the World Wide Web..."
 * 
 * Why chunks?
 * - Keep context window small for AI models
 * - Enable semantic search (find relevant content)
 * - Store embeddings (vector representations for similarity search)
 */

const mongoose = require("mongoose");

const ChunkSchema = new mongoose.Schema({
    /**
     * documentId: Which document this chunk came from
     * References the Document model
     */
    documentId: {
        type: mongoose.Schema.Types.ObjectId,
        ref: "Document"
    },

    /**
     * index: Position of this chunk in the document
     * Example: index=0 is the 1st chunk, index=1 is the 2nd chunk
     * Useful for maintaining order
     */
    index: Number,

    /**
     * text: The actual text content of this chunk
     * Example: "Machine learning is a subset of artificial intelligence
     *           that focuses on enabling systems to learn and improve..."
     */
    text: String,

    /**
     * embedding: Vector representation of the text for semantic search
     * - Type: [Number] (array of numbers, 384-1536 dimensions)
     * - Generated by: Hugging Face embedding model (future)
     * - Used for: Finding similar chunks when user asks a question
     * 
     * Example:
     * embedding: [0.15, -0.32, 0.89, ..., 0.12]  // 1024 numbers
     * 
     * How RAG works:
     * 1. User asks: "What is ML?"
     * 2. Convert question to embedding: [0.16, -0.30, 0.91, ...]
     * 3. Find chunks with similar embeddings
     * 4. Send relevant chunks + question to AI
     * 5. AI generates answer
     */
    embedding: [Number]
},
{
    // Auto-add createdAt and updatedAt fields
    timestamps: true
});

/**
 * Export the Chunk model
 * Future usage:
 * - Chunk.create({ documentId, index, text, embedding })
 * - Chunk.find({ documentId: id }) // Get all chunks for a document
 * - Vector search: Find chunks similar to user's question
 */
module.exports = mongoose.model("Chunk", ChunkSchema);
